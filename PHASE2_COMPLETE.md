# โ ูุฑุญูู 2: ูุฑุงูุชโุงูุฏ - ฺฉุงูู ุดุฏ!

## ๐ฏ ฺุฒูุง ฺฉู ูพุงุฏูโุณุงุฒ ุดุฏ

### 1. ุณุฑูุณ ุงุญุฑุงุฒ ููุช (`src/services/auth.js`)
- โ `tokenManager` - ูุฏุฑุช JWT token ุฏุฑ localStorage
- โ `userManager` - ูุฏุฑุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
- โ `authService` - ุณุฑูุณ Login, Logout, Register
- โ `getAuthHeaders` - ุงุถุงูู ฺฉุฑุฏู token ุจู API calls

### 2. ุตูุญู Login (`src/pages/Login.jsx`)
- โ ูุฑู ูุฑูุฏ ุจุง UI ุฒุจุง
- โ ููุงุด ุฎุทุงูุง
- โ Loading state
- โ ููุงุด ุญุณุงุจโูุง ุขุฒูุงุด

### 3. Protected Routes (`src/components/ProtectedRoute.jsx`)
- โ ูุญุงูุธุช ุงุฒ ุตูุญุงุช
- โ ุจุฑุฑุณ ุงุญุฑุงุฒ ููุช
- โ ุจุฑุฑุณ ููุด ฺฉุงุฑุจุฑ (role-based)
- โ Redirect ุจู Login ุง ุตูุญู ุงุตู

### 4. Sidebar ุจุง ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ (`src/components/Navbar.jsx`)
- โ ููุงุด ูุงู ฺฉุงุฑุจุฑ
- โ ููุงุด ููุด ฺฉุงุฑุจุฑ (ุจุง ุขฺฉูู)
- โ ูุฎู ฺฉุฑุฏู "ูุงฺฏ ูุนุงูุชโูุง" ุจุฑุง ุบุฑ super_admin
- โ ุฏฺฉูู ุฎุฑูุฌ

### 5. ฺฉูพุงุฑฺูโุณุงุฒ ุจุง API (`src/services/api.js`)
- โ ุงุถุงูู ฺฉุฑุฏู token ุจู ููู request ูุง
- โ ูุฏุฑุช ุฎุทุงูุง ุงุญุฑุงุฒ ููุช

### 6. ุตูุญู 403 Forbidden (`src/pages/Forbidden.jsx`)
- โ ููุงุด ุฎุทุง ุฏุณุชุฑุณ ููููุน
- โ ุฏฺฉูู ุจุงุฒฺฏุดุช

---

## ๐จ ุงุณุชุงูโูุง

- โ `src/styles/Login.css` - ุงุณุชุงู ุตูุญู Login
- โ `src/styles/Forbidden.css` - ุงุณุชุงู ุตูุญู 403
- โ `src/components/Sidebar.css` - ุงุณุชุงู Sidebar ุจุง ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ

---

## ๐ ูุงุจูุชโูุง ูพุงุฏูโุณุงุฒ ุดุฏู

### ูุฏุฑุช Token
```javascript
import { tokenManager } from './services/auth';

// ุฐุฎุฑู token
tokenManager.setToken('your_token_here');

// ุฏุฑุงูุช token
const token = tokenManager.getToken();

// ุญุฐู token
tokenManager.removeToken();

// ุจุฑุฑุณ ูุฌูุฏ token
const hasToken = tokenManager.hasToken();
```

### ูุฏุฑุช ฺฉุงุฑุจุฑ
```javascript
import { userManager } from './services/auth';

// ุฐุฎุฑู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
userManager.setUser({ id: 1, username: 'admin', role: 'super_admin' });

// ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
const user = userManager.getUser();

// ุจุฑุฑุณ ููุด
const isSuperAdmin = userManager.isSuperAdmin();
const isAdmin = userManager.isAdmin();
```

### ุงุญุฑุงุฒ ููุช
```javascript
import { authService } from './services/auth';

// ูุฑูุฏ
await authService.login({ username: 'admin', password: '123' });

// ุฎุฑูุฌ
authService.logout();

// ุจุฑุฑุณ ูุงฺฏู
const isAuth = authService.isAuthenticated();

// ุฏุฑุงูุช ฺฉุงุฑุจุฑ ุฌุงุฑ
const user = await authService.getCurrentUser();
```

### Protected Routes
```jsx
// ูุญุงูุธุช ุณุงุฏู
<ProtectedRoute>
  <Members />
</ProtectedRoute>

// ูุญุงูุธุช ุจุง ููุด ุฎุงุต
<ProtectedRoute requiredRole="super_admin">
  <ActivityLogs />
</ProtectedRoute>

// ูุญุงูุธุช ุจุง ฺูุฏ ููุด
<ProtectedRoute requiredRole={['admin', 'super_admin']}>
  <AdminPanel />
</ProtectedRoute>
```

---

## ๐ ูุญูู ุงุณุชูุงุฏู

### 1. ุงุฌุฑุง ุจฺฉโุงูุฏ
```bash
cd backend
npm run dev
```

### 2. ุงุฌุฑุง ูุฑุงูุชโุงูุฏ
```bash
npm run dev
```

### 3. ูุฑูุฏ ุจู ุณุณุชู
- ูุฑุงุฌุนู ุจู `http://localhost:5173`
- ุงุณุชูุงุฏู ุงุฒ ุญุณุงุจโูุง ุขุฒูุงุด:
  - **Super Admin**: `superadmin` / `Admin@123`
  - **Admin**: `admin1` / `Admin123`

---

## ๐ฑ ุฌุฑุงู ฺฉุงุฑุจุฑ (User Flow)

### ฺฉุงุฑุจุฑ ูุงฺฏู ูฺฉุฑุฏู:
1. ูุฑุงุฌุนู ุจู ูุฑ ุตูุญู โ Redirect ุจู `/login`
2. ูุฑูุฏ ุงุทูุงุนุงุช ู Login
3. ุฐุฎุฑู token ู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุฏุฑ localStorage
4. Redirect ุจู `/members`

### ฺฉุงุฑุจุฑ ูุงฺฏู ฺฉุฑุฏู:
1. ููุงุด Sidebar ุจุง ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
2. ุฏุณุชุฑุณ ุจู ุตูุญุงุช ูุฌุงุฒ
3. ูุฎู ุจูุฏู ููููุง ุบุฑูุฌุงุฒ (ูุซู Activity Logs ุจุฑุง admin ุนุงุฏ)

### ุฎุฑูุฌ:
1. ฺฉูฺฉ ุฑู ุฏฺฉูู ุฎุฑูุฌ
2. ุชุฃุฏ ุฎุฑูุฌ
3. ุญุฐู token ู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
4. Redirect ุจู `/login`

---

## ๐ฏ ุชูุงูุช ููุดโูุง ุฏุฑ UI

### Super Admin (ูุฏุฑ ุงุฑุดุฏ) ๐
- โ ุฏุณุชุฑุณ ุจู ููู ุตูุญุงุช
- โ ุฏุณุชุฑุณ ุจู "ูุงฺฏ ูุนุงูุชโูุง"
- โ ููุงุด ุขฺฉูู ๐ ุฏุฑ Sidebar

### Admin (ูุฏุฑ) ๐ค
- โ ุฏุณุชุฑุณ ุจู ุงุนุถุงุ ุญุถูุฑ ู ุบุงุจุ ูุงูุ ฺฏุฒุงุฑุดุงุชุ AI
- โ ุนุฏู ุฏุณุชุฑุณ ุจู "ูุงฺฏ ูุนุงูุชโูุง"
- โ ููุงุด ุขฺฉูู ๐ค ุฏุฑ Sidebar

### User (ฺฉุงุฑุจุฑ) ๐ฅ
- โ๏ธ ุฏุณุชุฑุณ ูุญุฏูุฏ (ูุงุจู ุชูุธู)
- โ ููุงุด ุขฺฉูู ๐ฅ ุฏุฑ Sidebar

---

## ๐ ุงููุช

### Token Management
- Token ุฏุฑ localStorage ุฐุฎุฑู ูโุดูุฏ
- Token ุจุง ูุฑ request ุงุฑุณุงู ูโุดูุฏ
- ุฏุฑ ุตูุฑุช ูุงูุนุชุจุฑ ุจูุฏู tokenุ ฺฉุงุฑุจุฑ logout ูโุดูุฏ

### Protected Routes
- ููู ุตูุญุงุช ุจุง `ProtectedRoute` ูุญุงูุธุช ุดุฏูโุงูุฏ
- ุจุฑุฑุณ ุงุญุฑุงุฒ ููุช ูุจู ุงุฒ ููุงุด ุตูุญู
- ุจุฑุฑุณ ููุด ฺฉุงุฑุจุฑ ุจุฑุง ุตูุญุงุช ุฎุงุต

### API Security
- ููู API calls ุดุงูู Authorization header ูุณุชูุฏ
- ูุฏุฑุช ุฎูุฏฺฉุงุฑ ุฎุทุงูุง 401 ู 403

---

## ๐ ูุงูโูุง ุงุฌุงุฏ ุดุฏู

```
src/
โโโ services/
โ   โโโ auth.js                    # ุณุฑูุณ ุงุญุฑุงุฒ ููุช
โโโ components/
โ   โโโ ProtectedRoute.jsx         # ฺฉุงููพูููุช ูุญุงูุธุช ุงุฒ route ูุง
โ   โโโ Navbar.jsx                 # Sidebar ุจุง ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ (ุขูพุฏุช ุดุฏู)
โโโ pages/
โ   โโโ Login.jsx                  # ุตูุญู ูุฑูุฏ
โ   โโโ Forbidden.jsx              # ุตูุญู 403
โโโ styles/
โ   โโโ Login.css                  # ุงุณุชุงู Login
โ   โโโ Forbidden.css              # ุงุณุชุงู 403
โโโ App.jsx                        # Route ูุง (ุขูพุฏุช ุดุฏู)
```

---

## ๐งช ุชุณุช

### ุชุณุช 1: ูุฑูุฏ Super Admin
1. ูุฑูุฏ ุจุง `superadmin` / `Admin@123`
2. ุจุฑุฑุณ ููุงุด "ูุงฺฏ ูุนุงูุชโูุง" ุฏุฑ ููู โ
3. ุฏุณุชุฑุณ ุจู `/activity-logs` โ

### ุชุณุช 2: ูุฑูุฏ Admin ุนุงุฏ
1. ูุฑูุฏ ุจุง `admin1` / `Admin123`
2. ุจุฑุฑุณ ุนุฏู ููุงุด "ูุงฺฏ ูุนุงูุชโูุง" ุฏุฑ ููู โ
3. ุชูุงุด ุจุฑุง ุฏุณุชุฑุณ ุจู `/activity-logs` โ Redirect ุจู `/members` โ

### ุชุณุช 3: ุฎุฑูุฌ
1. ฺฉูฺฉ ุฑู ุฏฺฉูู ุฎุฑูุฌ
2. ุชุฃุฏ ุฎุฑูุฌ
3. Redirect ุจู `/login` โ
4. ุนุฏู ุฏุณุชุฑุณ ุจู ุตูุญุงุช ูุญุงูุธุช ุดุฏู โ

### ุชุณุช 4: ุฏุณุชุฑุณ ุจุฏูู Login
1. ูพุงฺฉ ฺฉุฑุฏู localStorage
2. ุชูุงุด ุจุฑุง ุฏุณุชุฑุณ ุจู `/members`
3. Redirect ุจู `/login` โ

---

## ๐ก ูฺฉุงุช ููู

### localStorage Keys
- `gym_auth_token` - JWT token
- `gym_user_data` - ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ (JSON)

### Token Expiration
- Token ุนูุฑ 7 ุฑูุฒู ุฏุงุฑุฏ
- ุจุนุฏ ุงุฒ 7 ุฑูุฒุ ฺฉุงุฑุจุฑ ุจุงุฏ ุฏูุจุงุฑู login ฺฉูุฏ

### Refresh on Login/Logout
- ุจุนุฏ ุงุฒ loginุ ุตูุญู refresh ููโุดูุฏ (SPA)
- ุจุนุฏ ุงุฒ logoutุ ุจุง `window.location.href` ุจู login ูโุฑูุฏ

---

## ๐ ุฎูุงุตู

ูุฑุญูู 2 ุจุง ููููุช ฺฉุงูู ุดุฏ! ุญุงูุง ุณุณุชู ุงุญุฑุงุฒ ููุช ฺฉุงูู ุฏุงุฑู:

- โ ุตูุญู Login ุฒุจุง ู ฺฉุงุฑุจุฑูพุณูุฏ
- โ ูุฏุฑุช Token ุฏุฑ localStorage
- โ Protected Routes ุจุง ุจุฑุฑุณ ููุด
- โ Sidebar ุจุง ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
- โ ูุฎู ฺฉุฑุฏู ููููุง ุจุฑ ุงุณุงุณ ููุด
- โ ุฏฺฉูู ุฎุฑูุฌ
- โ ฺฉูพุงุฑฺูโุณุงุฒ ฺฉุงูู ุจุง ุจฺฉโุงูุฏ

**ุชุงุฑุฎ ุชฺฉูู**: 10 ููุงูุจุฑ 2025
**ูุถุนุช**: โ ฺฉุงูู ู ุขูุงุฏู ุงุณุชูุงุฏู
